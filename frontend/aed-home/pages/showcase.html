<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AED Showcase - Live Examples</title>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.umd.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Rajdhani', sans-serif;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
      color: #e0e0e0;
      min-height: 100vh;
      padding: 40px 20px;
    }
    .container { max-width: 1400px; margin: 0 auto; }
    h1 {
      font-size: 3em;
      color: #00ff88;
      margin-bottom: 10px;
      text-shadow: 0 0 20px rgba(0,255,136,0.5);
      text-align: center;
    }
    .subtitle {
      text-align: center;
      font-size: 1.3em;
      color: #888;
      margin-bottom: 50px;
    }
    .showcase-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 30px;
      margin-bottom: 50px;
    }
    .showcase-card {
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      padding: 30px;
      border: 2px solid rgba(255,255,255,0.1);
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }
    .showcase-card:hover {
      transform: translateY(-5px);
      border-color: #00ff88;
      box-shadow: 0 20px 40px rgba(0,255,136,0.2);
    }
    .showcase-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00ff88, #667eea, #764ba2);
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .domain-name {
      font-size: 1.8em;
      font-weight: 700;
      color: #e0e0e0;
    }
    .token-id {
      background: #667eea;
      color: white;
      padding: 5px 15px;
      border-radius: 20px;
      font-weight: 600;
    }
    .nft-preview {
      width: 100%;
      height: 300px;
      background: linear-gradient(135deg, rgba(0,255,136,0.1), rgba(102,126,234,0.1));
      border-radius: 15px;
      margin: 20px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid rgba(255,255,255,0.1);
      position: relative;
      overflow: hidden;
    }
    .nft-preview img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    .evolution-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(0,255,136,0.9);
      color: #0a0e27;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 700;
      font-size: 1.1em;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin: 20px 0;
    }
    .stat-box {
      background: rgba(0,255,136,0.1);
      border: 1px solid rgba(0,255,136,0.3);
      border-radius: 10px;
      padding: 15px;
      text-align: center;
    }
    .stat-value {
      font-size: 2em;
      font-weight: 700;
      color: #00ff88;
    }
    .stat-label {
      font-size: 0.9em;
      color: #888;
      margin-top: 5px;
    }
    .fragments-list {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }
    .fragment-badge {
      background: rgba(102,126,234,0.2);
      border: 1px solid #667eea;
      color: #667eea;
      padding: 6px 14px;
      border-radius: 15px;
      font-size: 0.9em;
      font-weight: 500;
    }
    .fragment-badge.ai {
      background: rgba(0,255,136,0.2);
      border-color: #00ff88;
      color: #00ff88;
    }
    .section-title {
      font-size: 2em;
      color: #00ff88;
      margin: 50px 0 30px 0;
      text-align: center;
    }
    .comparison-table {
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      padding: 30px;
      margin: 30px 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    th {
      color: #00ff88;
      font-weight: 700;
      font-size: 1.1em;
    }
    .check { color: #00ff88; }
    .cross { color: #ff4444; }
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(10,14,39,0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(0,255,136,0.3);
      border-top-color: #00ff88;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .capability-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-top: 15px;
    }
    .capability-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
    }
    .cap-icon {
      font-size: 1.5em;
    }
    .cap-icon.unlocked { filter: grayscale(0); }
    .cap-icon.locked { filter: grayscale(1); opacity: 0.3; }
  </style>
</head>
<body>
  <div id="loading" class="loading-overlay">
    <div>
      <div class="loading-spinner"></div>
      <p style="text-align: center; margin-top: 20px; color: #00ff88;">Loading live examples from blockchain...</p>
    </div>
  </div>

  <div class="container">
    <h1>üåü AED Showcase</h1>
    <p class="subtitle">Live examples of evolved domains and AI badges from Polygon Amoy</p>

    <div id="showcaseGrid" class="showcase-grid"></div>

    <h2 class="section-title">Evolution Comparison</h2>
    <div class="comparison-table">
      <table>
        <thead>
          <tr>
            <th>Domain</th>
            <th>Type</th>
            <th>Evolution Level</th>
            <th>Fragments</th>
            <th>Special Features</th>
          </tr>
        </thead>
        <tbody id="comparisonTable">
          <tr><td colspan="5" style="text-align: center; color: #888;">Loading data...</td></tr>
        </tbody>
      </table>
    </div>

    <h2 class="section-title">Why This Matters</h2>
    <div class="showcase-grid">
      <div class="showcase-card">
        <h3 style="color: #00ff88; margin-bottom: 15px;">üîê Verifiable Identity</h3>
        <p style="line-height: 1.6; color: #aaa;">
          Every badge is an on-chain NFT that proves AI agent identity. 
          No more fake agents or impersonation - ownership is verifiable via blockchain.
        </p>
      </div>
      <div class="showcase-card">
        <h3 style="color: #00ff88; margin-bottom: 15px;">‚ö° Capability Gating</h3>
        <p style="line-height: 1.6; color: #aaa;">
          AI agents can only access capabilities unlocked on their badge. 
          Vision, memory, communication - all gated and controlled by the badge owner.
        </p>
      </div>
      <div class="showcase-card">
        <h3 style="color: #00ff88; margin-bottom: 15px;">üé® Visual Evolution</h3>
        <p style="line-height: 1.6; color: #aaa;">
          As agents unlock achievements and capabilities, their NFT evolves visually. 
          Reputation is visible, provable, and portable.
        </p>
      </div>
    </div>
  </div>

  <script>
    const CONTRACT_ADDRESS = "0x45e441F9e722aAC73784F49A4bad8aF45B95A5DC";
    const RPC_URL = "https://rpc-amoy.polygon.technology";
    
    const ABI = [
      "function getDomainByTokenId(uint256 tokenId) view returns (string)",
      "function isAISubdomain(uint256 tokenId) view returns (bool)",
      "function getModelType(uint256 tokenId) view returns (string)",
      "function getActiveCapabilities(uint256 tokenId) view returns (string[])",
      "function getTokenFragments(uint256 tokenId) view returns (tuple(string fragmentType, uint256 earnedAt, bytes32 eventHash)[])",
      "function getEvolutionLevel(uint256 tokenId) view returns (uint256)",
      "function tokenURI(uint256 tokenId) view returns (string)"
    ];

    // Example token IDs from deployed contract
    const SHOWCASE_TOKENS = [1, 2, 6, 7, 8, 9];

    async function loadShowcase() {
      try {
        const provider = new ethers.JsonRpcProvider(RPC_URL);
        const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, provider);

        const showcaseDiv = document.getElementById('showcaseGrid');
        const comparisonTable = document.getElementById('comparisonTable');
        
        showcaseDiv.innerHTML = '';
        comparisonTable.innerHTML = '';

        for (const tokenId of SHOWCASE_TOKENS) {
          try {
            const domain = await contract.getDomainByTokenId(tokenId);
            const isBadge = await contract.isAISubdomain(tokenId);
            const fragments = await contract.getTokenFragments(tokenId);
            const level = await contract.getEvolutionLevel(tokenId);
            const tokenURI = await contract.tokenURI(tokenId);

            let modelType = null;
            let capabilities = [];

            if (isBadge) {
              modelType = await contract.getModelType(tokenId);
              capabilities = await contract.getActiveCapabilities(tokenId);
            }

            // Create showcase card
            const card = createShowcaseCard(tokenId, domain, isBadge, level, fragments, modelType, capabilities, tokenURI);
            showcaseDiv.appendChild(card);

            // Add to comparison table
            const row = createComparisonRow(domain, isBadge, level, fragments.length, modelType, capabilities);
            comparisonTable.appendChild(row);
          } catch (error) {
            console.error(`Error loading token ${tokenId}:`, error);
          }
        }

        document.getElementById('loading').style.display = 'none';
      } catch (error) {
        console.error("Error loading showcase:", error);
        document.getElementById('loading').innerHTML = `
          <div>
            <div style="color: #ff4444; font-size: 1.5em; margin-bottom: 20px;">‚ö†Ô∏è Error Loading Data</div>
            <p style="color: #888;">${error.message}</p>
            <button onclick="location.reload()" style="margin-top: 20px; padding: 10px 30px; background: #00ff88; border: none; border-radius: 8px; cursor: pointer;">
              Retry
            </button>
          </div>
        `;
      }
    }

    function createShowcaseCard(tokenId, domain, isBadge, level, fragments, modelType, capabilities, tokenURI) {
      const card = document.createElement('div');
      card.className = 'showcase-card';

      const fragmentBadges = fragments.map(f => 
        `<span class="fragment-badge ${f.fragmentType.startsWith('ai_') ? 'ai' : ''}">${f.fragmentType}</span>`
      ).join('');

      let capabilityHTML = '';
      if (isBadge) {
        const allCaps = [
          { name: 'communication', icon: 'üó®Ô∏è' },
          { name: 'vision', icon: 'üëÅÔ∏è' },
          { name: 'memory', icon: 'üß†' },
          { name: 'reasoning', icon: 'üéØ' }
        ];
        capabilityHTML = `
          <div style="margin-top: 20px;">
            <strong>Capabilities:</strong>
            <div class="capability-grid">
              ${allCaps.map(cap => {
                const unlocked = capabilities.includes(`ai_${cap.name}`);
                return `
                  <div class="capability-item">
                    <span class="cap-icon ${unlocked ? 'unlocked' : 'locked'}">${cap.icon}</span>
                    <span style="color: ${unlocked ? '#00ff88' : '#666'};">${cap.name}</span>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
        `;
      }

      card.innerHTML = `
        <div class="card-header">
          <div class="domain-name">${domain}</div>
          <span class="token-id">#${tokenId}</span>
        </div>
        ${isBadge ? `<div style="color: #667eea; margin-bottom: 10px; font-weight: 600;">ü§ñ AI Badge: ${modelType}</div>` : ''}
        <div class="nft-preview">
          <div class="evolution-badge">Level ${level}</div>
          <div style="text-align: center;">
            <div style="font-size: 3em; margin-bottom: 10px;">
              ${isBadge ? 'ü§ñ' : 'üåê'}
            </div>
            <div style="color: #888;">NFT Preview</div>
          </div>
        </div>
        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-value">${level}</div>
            <div class="stat-label">Evolution</div>
          </div>
          <div class="stat-box">
            <div class="stat-value">${fragments.length}</div>
            <div class="stat-label">Fragments</div>
          </div>
          <div class="stat-box">
            <div class="stat-value">${isBadge ? capabilities.length : 'N/A'}</div>
            <div class="stat-label">Capabilities</div>
          </div>
        </div>
        <div style="margin-top: 20px;">
          <strong>Fragments:</strong>
          <div class="fragments-list">
            ${fragmentBadges || '<span style="color: #888;">No fragments yet</span>'}
          </div>
        </div>
        ${capabilityHTML}
        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
          <a href="${tokenURI}" target="_blank" style="color: #667eea; text-decoration: none;">
            View Metadata ‚Üí
          </a>
        </div>
      `;

      return card;
    }

    function createComparisonRow(domain, isBadge, level, fragmentCount, modelType, capabilities) {
      const row = document.createElement('tr');
      
      const specialFeatures = [];
      if (isBadge) specialFeatures.push(`AI: ${modelType}`);
      if (capabilities.includes('ai_vision')) specialFeatures.push('Vision');
      if (capabilities.includes('ai_memory')) specialFeatures.push('Memory');
      if (level >= 5) specialFeatures.push('High Evolution');

      row.innerHTML = `
        <td><strong>${domain}</strong></td>
        <td>${isBadge ? 'ü§ñ Badge' : 'üåê Domain'}</td>
        <td><span style="color: #00ff88; font-weight: 600;">Level ${level}</span></td>
        <td>${fragmentCount} fragments</td>
        <td>${specialFeatures.join(', ') || 'Standard'}</td>
      `;

      return row;
    }

    // Load on page load
    loadShowcase();
  </script>
</body>
</html>
